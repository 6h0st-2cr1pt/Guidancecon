{% extends 'sysadmin/base.html' %}
{% load static %}
{% block title %}Availability{% endblock %}
{% block content %}
  <h2 class="page-title">Availability</h2>
  
  <!-- Date Picker -->
  <div class="date-picker-container glassmorphism">
    <label for="date-picker" class="date-picker-label">Select Date:</label>
    <input type="date" id="date-picker" value="{{ date_str }}" min="{% now 'Y-m-d' %}" class="date-picker-input">
    <small class="date-picker-hint">
      💡 You can set different availability for each date. Select a date, toggle the time slots, then select another date to set its availability.
    </small>
  </div>
  
  <section class="section">
    <div class="section-header">{{ date }}</div>
    <div class="section-body times">
      {% for slot in slots %}
      <div class="slot {% if not slot.available %}disabled{% endif %}" data-slot-id="{{ slot.id }}" data-slot="{{ slot.hour }}">
        <span>{{ slot.label }}</span>
        <div>
          {% if slot.available %}
            <span class="badge">Available</span>
          {% else %}
            <span class="badge red">Not Available</span>
          {% endif %}
          <input class="switch" type="checkbox" {% if slot.available %}checked{% endif %} data-slot-id="{{ slot.id }}">
        </div>
      </div>
      {% endfor %}
    </div>
  </section>

  <!-- Availability Summary -->
  <div class="availability-summary glassmorphism">
    <h3 class="summary-title">📅 Availability Summary (Next 7 Days)</h3>
    <div class="summary-grid">
      {% for day in summary_dates %}
      <div data-date="{{ day.date_str }}" class="summary-day {% if day.date == date %}current-day{% endif %}">
        <div class="day-date">{{ day.date|date:"M d" }}</div>
        <div class="day-name">{{ day.date|date:"D" }}</div>
        <div class="day-slots">
          <span class="slots-count {% if day.available_count > 0 %}available{% else %}unavailable{% endif %}">
            {{ day.available_count }}/{{ day.total_slots }} slots
          </span>
        </div>
        {% if day.date == date %}
        <div class="current-indicator">← Current</div>
        {% endif %}
      </div>
      {% endfor %}
    </div>
    <div class="summary-hint">
      Click on any date above to set its availability, or use the date picker above.
    </div>
  </div>

  <script src="{% static 'js/availability.js' %}"></script>
{% endblock %}


